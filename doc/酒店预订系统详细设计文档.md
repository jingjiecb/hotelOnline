# 酒店预定系统（HRS）软件详细设计描述文档

[TOC]

## 文档修改历史

| 修改人员 | 日期      | 修改原因                                | 版本号 |
| :------: | --------- | --------------------------------------- | ------ |
|  何知谦  | 2020.5.18 | 添加引言、结构视角orderbl模块           | v0.1.1 |
|  王崇羽  | 2020.5.18 | 添加couponbl模块、adminbl模块、依赖视角 | v0.1.2 |
|  刘子龙  | 2020.5.18 | 添加产品概述、hotelbl模块               | v0.1.3 |
|  刘一也  | 2020.5.18 | 添加体系结构设计概述、userbl模块        | v0.1.4 |
|  王崇羽  | 2020.6.12 | 添加目录、统一调整表格格式              | v0.1.5 |

## 1. 引言

### 1.1 编制目的

本报告详细完成对连锁商店管理系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。

本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 1.2 词汇表

| 词汇名称 | 词汇含义                               | 备注 |
| -------- | -------------------------------------- | ---- |
| VO       | Value Object，值对象                   |      |
| PO       | Persistent Object，持久化对象          |      |
| HRS      | Hotel Reservation System，酒店预订系统 |      |

### 1.3 参考资料

软工二大作业迭代一功能需求简述.pdf

《软件工程与计算（卷二）软件开发技术基础》



## 2. 产品概述

参考酒店预订系统用例文档和酒店预订系统软件需求规格说明文档中对产品的概括描述。



## 3.体系结构设计概述

​	参考酒店管理系统用例文档和酒店管理系统软件需求规格说明文档中对产品的概括描述。



## 4. 结构视角
### 4.1 业务逻辑层的分解

业务逻辑层的开发包图参见软件体系结构文档。

#### 4.1.1 hotelbl

##### (1)模块概述

hotelbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

hotelbl模块的职责及接口参见软件体系结构说明文档。

##### (2)整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。例如，为了隔离展示层和业务逻辑层，我们添加了HotelController，并且在HotelController和具体的业务逻辑实现之间都依赖接口，降低了耦合性。HotelPO和HotelRoomPO是作为酒店和房间数据的持久化对象被添加到设计模型中去的。

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/hotelbl/mokuai.png)

hotelbl模块的各个类的职责如下表所示：

| 模块            | 职责                                     |
| --------------- | ---------------------------------------- |
| HotelController | 负责接收前端请求，调用相应的业务逻辑     |
| HotelblService  | 负责实现酒店信息查询管理所需要的服务     |
| RoomblService   | 负责实现酒店房间信息查询管理所需要的服务 |

##### (3)模块内部类的接口规范

HotelController和HotelblService及RoomblService的接口规范如下两表所示：

<table style="border-collapse:collapse;border-spacing:0" class="tg"><tr><th style="font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" colspan="3">HotelblService和RoomBlService提供的接口</th></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">addHotel</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:middle">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:middle">public void addHotel(HotelVO hotelVO);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:middle">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:middle">要插入酒店的管理员不能为空，而且当前操作用户必须为网站管理人。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">在数据库中插入单一持久化酒店对象。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">updateRoomInfo</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">public void updateRoomInfo(Integer hotelId, String roomType,Integer rooms);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">hotelId是数据库中存在的合理值，roomType是枚举的一种，rooms为合理整数。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">在数据库中更新对应酒店的这种房间的数量信息。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">getRoomCurNum</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">public int<span style="font-weight:bold"> </span>getRoomCurNum(Integer hotelId, String roomType);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">hotelId必须是数据库中已经存在的合法值，roomType是枚举的一种。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">查找到对应酒店的对应房间类型房间的数量。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">retrieveHotels</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">public List&lt;HotelVO&gt; retrieveHotels();</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">数据库已启动并且可正常访问。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">查询得到所有酒店列表。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">retrieveHotelDetails</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">public HotelVO retrieveHotelDetails(Integer hotelId);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">hotelId是数据库中已经存在的合法值。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">查询得到对应酒店的数据对象。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:middle" rowspan="3">getHotelOrders</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">public List&lt;Order&gt; getHotelOrders(Integer hotelId);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">hotelId是数据库中已经存在的合法值。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">查询得到对应酒店的所有订单数据对象列表</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:center;vertical-align:middle" rowspan="3">retrieveHotelRoomInfo</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">public List&lt;HotelRoom&gt; retrieveHotelRoomInfo(Integer hotelId);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">hotelId是数据库中已经存在的合法值。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">查找得到对应酒店的房间数据对象列表。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:center;vertical-align:middle" rowspan="3">insertRoomInfo</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">public void<span style="font-weight:bold"> </span>insertRoomInfo(HotelRoom hotelRoom);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">hotelRoom的roomType为合法枚举值，hotelId为已存在的合法值，price和总数total合理</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">在数据库中插入单一持久房间对象</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:center;vertical-align:middle" rowspan="3">updateRoomInfo</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">public void<span style="font-weight:bold"> </span>updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">hotelId是数据库中存在的合理值，roomType是枚举的一种，rooms为合理整数。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">在数据库中更新对应酒店的这种房间的数量信息。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:center;vertical-align:middle" rowspan="3">getRoomCurNum</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">语法</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">public int getRoomCurNum(Integer hotelId, String roomType);</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">前置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">hotelId必须是数据库中已经存在的合法值，roomType是枚举的一种。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">后置条件</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">查找到对应酒店的对应房间类型房间的数量。</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:top" colspan="3">需要的服务</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:top" colspan="2">服务名</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:center;vertical-align:top">服务</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top" colspan="2">accountService.getUserInfo(int id)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">获得酒店的管理员单一持久化对象</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top" colspan="2">hotelMapper.insertHotel(Hotel h)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:inherit;text-align:left;vertical-align:top">向数据库中插入酒店单一持久化对象</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">hotelMapper.selectAllHotel</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">获得所有酒店数据对象列表</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">hotelMapper.selectById(int id)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">按照id查询获得酒店数据对象</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">hotelVO.setRooms(roomVOS)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">给酒店数据对象插入房间数据对象列表</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">orderService.getAllOrders</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">获得所有订单数据对象列表</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">roomMapper.selectRoomsByHotelId(int id)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">根据酒店ID查询获得所有房间数据对象列表</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">roomMapper.insertRoom(HotelRoom r)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">向数据库中插入房间单一持久化对象</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">roomMapper.updateRoomInfo(int id,roomType t,int n)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">更新数据库对应酒店的对应房间类型的房间数量</td></tr><tr><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top" colspan="2">roomMapper.getRoomCurNum(int id,roomType t)</td><td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;text-align:left;vertical-align:top">查询数据库获得对应酒店的对应类型房间的数量</td></tr></table>



<table style="border-collapse:collapse;border-spacing:0" class="tg"><thead><tr><th style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" colspan="3"><span style="font-weight:normal">HotelController提供的接口</span></th></tr></thead><tbody><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">createHotel</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal">public ResponseVO createHotel(HotelVO hotelVO)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:middle;word-break:normal">已创建一个HotelVO对象，并赋予合理的值</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用业务实现的addHotel方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">retrieveAllHotels</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">public ResponseVO retrieveAllHotels(String userId)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">userId是已存在的合理用户Id</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用hotelService的retrieveHotels方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">addRoomInfo</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">public ResponseVO addRoomInfo(HotelRoom hotelRoom)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">已创建一个HotelRoom对象，并赋予合理的值</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用roomService的insertRoomInfo方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">updateHotel</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">public ResponseVO updateHotel(Hotel hotel)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">已创建一个Hotel对象，并赋予合理的值</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用hotelService的updateHotelInfo方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">retrieveHotelDetails</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">public ResponseVO retrieveHotelDetail(Integer hotelId)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">hotelId是数据库中已经存在的合法值。</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用hotelSevice的retrieveHotelDetails方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:middle;word-break:normal" rowspan="3">deleteHotel</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">语法</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">public ResponseVO deleteHotel(Integer hotelId)</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">前置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">hotelId是数据库中已经存在的合法值。</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">后置条件</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">调用hotelService的deleteHotel方法</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:top;word-break:normal" colspan="3">需要的服务</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:top;word-break:normal" colspan="2">服务名</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:center;vertical-align:top;word-break:normal">服务</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">hotelService.addHotel(hotelVO)</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">添加酒店单一持久化对象</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">ResponseVO.buildSuccess</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">生成正确的返回消息</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">hotelMapper.selectAllHotel</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">获得所有酒店数据对象列表</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">roomService.insertRoomInfo(hotelRoom)</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">添加酒店房间单一持久化对象</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">hotelService.updateHotelInfo(hotel)</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">更新酒店信息</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">hotelService.retrieveHotelDetails(hotelId)</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">获得特定酒店的详细信息</td></tr><tr><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal" colspan="2">hotelService.deleteHotel(hotelId)</td><td style="border-color:inherit;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;text-align:left;vertical-align:top;word-break:normal">删除对应的酒店</td></tr></tbody></table>

##### (4)业务逻辑层的动态模型

下图表示了在酒店管理系统中，hotel业务逻辑处理的相关对象之间的关系。

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/hotelbl/shunxu.png)

##### (5)业务逻辑层的设计原理

利用委托式控制风格，每个页面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。

#### 4.1.2 userbl模块

##### (1)模块概述

userbl模块承担的需求参见规格说明文档功能需求及相关非功能需求。

userbl模块承担的职责及接口参见软件系统结构描述文档。

##### (2)整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。在展示层与业务逻辑层之间添加了AccountService接口，业务逻辑层与数据层之间添加了AccountMapper接口。为了隔离业务逻职责和逻辑控制职责，我们增加了AccountController。UserPO是销售劵持久化对象被添加到设计模型中去的。



Userbl的模块设计如图所示

![image](https://wx2.sbimg.cn/2020/06/18/-13.png)



 模块中各个类的职责如表所示：

| 模块              | 职责                                                         |
| ----------------- | ------------------------------------------------------------ |
| User              | 系统用户的领域模型对象，拥有用户数据的姓名和密码，可以解决注册、登录问题 |
| AccountController | 实现用户页面所需要的服务                                     |



##### (3)模块内部类的接口规范

AccountController和User的接口规范如表所示。

AccountController

供接口

|                                   | 提供的服务（供接口） |                                                              |
| --------------------------------- | -------------------- | ------------------------------------------------------------ |
|                                   | 语法                 | public ResponseVO login(@RequestBody UserForm userForm)      |
| AccountController.login           | 前置条件             | 有输入有效的用户信息                                         |
|                                   | 后置条件             | 用户登录成功                                                 |
|                                   | 语法                 | public ResponseVO registerAccount(@RequestBody UserVO userVO) |
| AccountController.registerAccount | 前置条件             | 有输入有效的注册信息                                         |
|                                   | 后置条件             | 用户注册成功                                                 |
|                                   | 语法                 | public ResponseVO getUserInfo(@PathVariable int id)          |
| AccountController.getUserInfo     | 前置条件             | 有现存的有效用户                                             |
|                                   | 后置条件             | 查询到用户信息                                               |
|                                   | 语法                 | public ResponseVO updateInfo(@RequestBody UserInfoVO userInfoVO,@PathVariable int id) |
| AccountController.updateInfo      | 前置条件             | 有现存的有效用户                                             |
|                                   | 后置条件             | 更新了指定用户信息                                           |
|                                   | 语法                 | public ResponseVO getCreditRecord(@PathVariable int userId)  |
| AccountController.getCreditRecord | 前置条件             | 有现存的有效用户                                             |
|                                   | 后置条件             | 返回用户信用记录信息                                         |
|                                   | 语法                 | public ResponseVO registerVip(@RequestBody VipInfoVO vipInfoVO, @PathVariable int id) |
| AccountController.registerVip     | 前置条件             | 有现存的有效用户                                             |
|                                   | 后置条件             | 更新了用户的vip信息                                          |

需接口

|                                | 需要的服务（需接口） |                                                              |
| ------------------------------ | -------------------- | ------------------------------------------------------------ |
|                                | 语法                 | User login(UserForm userForm)                                |
| accountService.login           | 前置条件             | 正确输入用户名和密码                                         |
|                                | 后置条件             | 登录成功 切换当前用户                                        |
|                                | 语法                 | ResponseVO registerAccount(UserVO userVO)                    |
| accountService.registerAccount | 前置条件             | 输入信息合法                                                 |
|                                | 后置条件             | 更新数据库 ，增肌用户信息                                    |
|                                | 语法                 | List<CreditRecord> getCreditRecord(int userId)               |
| accountService.getCreditRecord | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 返回信用值列表                                               |
|                                | 语法                 | User getUserInfo(int id)                                     |
| accountService.getUserInfo     | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 返回用户信息                                                 |
|                                | 语法                 | ResponseVO updateUserInfo(int id, String password, String username, String phonenumber, Date birthday) |
| accountService.updateUserInfo  | 前置条件             | 输入信息合法                                                 |
|                                | 后置条件             | 更新用户数据                                                 |
|                                | 语法                 | ResponseVO registerVip(int id,String vipType, String vipInfo) |
| accountService.registerVip     | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 更新用户数据                                                 |



User

供接口

|                                | 提供的服务（供接口） |                                                              |
| ------------------------------ | -------------------- | ------------------------------------------------------------ |
|                                | 语法                 | User login(UserForm userForm)                                |
| accountService.login           | 前置条件             | 正确输入用户名和密码                                         |
|                                | 后置条件             | 登录成功 切换当前用户                                        |
|                                | 语法                 | ResponseVO registerAccount(UserVO userVO)                    |
| accountService.registerAccount | 前置条件             | 输入信息合法                                                 |
|                                | 后置条件             | 更新数据库 ，增肌用户信息                                    |
|                                | 语法                 | List<CreditRecord> getCreditRecord(int userId)               |
| accountService.getCreditRecord | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 返回信用值列表                                               |
|                                | 语法                 | User getUserInfo(int id)                                     |
| accountService.getUserInfo     | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 返回用户信息                                                 |
|                                | 语法                 | ResponseVO updateUserInfo(int id, String password, String username, String phonenumber, Date birthday) |
| accountService.updateUserInfo  | 前置条件             | 输入信息合法                                                 |
|                                | 后置条件             | 更新用户数据                                                 |
|                                | 语法                 | ResponseVO registerVip(int id,String vipType, String vipInfo) |
| accountService.registerVip     | 前置条件             | 有现存的有效用户                                             |
|                                | 后置条件             | 更新用户数据                                                 |

需接口

|                                |          |                                                              |
| ------------------------------ | :------: | ------------------------------------------------------------ |
|                                |   语法   | int createNewAccount(User user)                              |
| accountMapper.createNewAccount | 前置条件 | 输入的数据合法                                               |
|                                | 后置条件 | 数据库增加新用户                                             |
|                                |   语法   | User getAccountByName(@Param("email") String email)          |
| accountMapper.getAccountByName | 前置条件 | 存在对应姓名的用户                                           |
|                                | 后置条件 | 返回用户信息                                                 |
|                                |   语法   | List<CreditRecord> getCreditRecord(@Param("userId") int userId) |
| accountMapper.getCreditRecord  | 前置条件 | 有现存的有效用户                                             |
|                                | 后置条件 | 返回信用记录列表                                             |
|                                |   语法   | User getAccountById(@Param("id") int id)                     |
| accountMapper.getAccountById   | 前置条件 | 有现存的有效用户                                             |
|                                | 后置条件 | 返回用户信息                                                 |
|                                |   语法   | int updateAccount(@Param("id") int id, @Param("password") String password, @Param("userName") String username, @Param("phoneNumber") String phonenumber, @Param("birthday")Date birthday) |
| accountMapper.updateAccount    | 前置条件 | 有现存的用户，用户信息合法                                   |
|                                | 后置条件 | 更新用户数据                                                 |
|                                |   语法   | int registerVip(@Param("id") int id, @Param("vipType") String vipType, @Param("vipInfo") String vipInfo) |
| accountMapper.registerVip      | 前置条件 | 有现存的用户，用户信息合法                                   |
|                                | 后置条件 | 更新用户数据                                                 |



##### (4)业务逻辑层的动态模型

![img](https://wx2.sbimg.cn/2020/06/18/-15.png)

##### (5)业务逻辑层的动态模型

如图是User对象在生存期间的状态序列、引起的转移事件以及伴随动作。只是很简单的由UI调用registerAccountAPI后转移到registerAccount状态，随后结束。

![](https://wx1.sbimg.cn/2020/06/18/-14.png)

#### 4.1.3 Couponbl模块

##### (1)模块概述

Couponbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

Couponbl模块的职责及接口参见软件体系结构描述文档。

##### (2)整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。在展示层与业务逻辑层之间添加了CouponMatchStrategy与CouponService接口，业务逻辑层与数据层之间添加了CouponMapper接口。为了隔离业务逻职责和逻辑控制职责，我们增加了CouponController。CouponPO是销售劵持久化对象被添加到设计模型中去的。同时加入strategyList存放策略匹配方法。

Couponbl的模块设计如图所示

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/couponbl%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1.png)

模块中各个类的职责如表所示

| 模块             | 职责                                                         |
| ---------------- | ------------------------------------------------------------ |
| CouponController | 实现优惠券页面所需要的服务                                   |
| Coupon           | 优惠券的领域模型对象，拥有类型、优惠价格、所需条件等信息，可以完成优惠界面所需服务 |

##### (3)模块内部类的接口规范

CouponController和Coupon的接口规范如表所示。

**CouponController**

**供接口**

| 接口名                    | 属性     | 内容                                                         |
| ------------------------- | -------- | ------------------------------------------------------------ |
|                           | 语法     | public ResponseVO deleteCoupon(@PathVariable int couponId)   |
| deleteCoupon              | 前置条件 | 有现存的coupon存在                                           |
|                           | 后置条件 | 数据库更新，删除对应coupon                                   |
|                           | 语法     | public ResponseVO addHotelTimeCoupon(@RequestBody HotelTimeCouponVO hotelTimeCouponVO) |
| addHotelTimeCoupon        | 前置条件 | 输入数据合法                                                 |
|                           | 后置条件 | 更新数据库，增加新的策略                                     |
|                           | 语法     | public ResponseVO addHotelBirthdayCoupon(@RequestBody HotelBirthdayCouponVO hotelBirthdayCouponVO) |
| addHotelBirthdayCoupon    | 前置条件 | 输入数据合法                                                 |
|                           | 后置条件 | 更新数据库，增加新的策略                                     |
|                           | 语法     | public ResponseVO addHotelTargetRoomCoupon(@RequestBody HotelTargetRoomCouponVO hotelTargetRoomCouponVO) |
| addHotelTargetRoomCoupon  | 前置条件 | 输入数据合法                                                 |
|                           | 后置条件 | 更新数据库，增加新的策略                                     |
|                           | 语法     | ResponseVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO hotelTargetMoneyCouponVO) |
| addHotelTargetMoneyCoupon | 前置条件 | 创建HotelTargetMoneyCouponVO类且符合语法输入条件             |
|                           | 后置条件 | 调用Coupon对应的addHotelTargetMoneyCoupon方法                |
|                           | 语法     | ResponseVO getHotelAllCoupons(Integer hotelId)               |
| getHotelAllCoupons        | 前置条件 | 符合语法输入条件                                             |
|                           | 后置条件 | 调用Coupon对应的getHotelAllCoupons方法                       |
|                           | 语法     | ResponseVO getOrderMatchCoupons(Integer userId,                                        hotelId, Double orderPrice,  Integer roomNum, String checkIn,  String checkOut) |
| getOrderMatchCoupons      | 前置条件 | 符合语法输入条件                                             |
|                           | 后置条件 | 调用Coupon对应的getOrderMatchCoupons方法                     |

**需接口**

| 接口名                                        | 属性     | 内容                                                         |
| --------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                               | 语法     | ResponseVO deleteCoupon(int CouponId);                       |
| couponService.deleteCoupon                    | 前置条件 | 输入信息合法                                                 |
|                                               | 后置条件 | 增加新的销售策略                                             |
|                                               | 语法     | CouponVO addHotelBirthdayCoupon(HotelBirthdayCouponVO couponVO); |
| couponService.addHotelBirthdayCoupon          | 前置条件 | 输入信息合法                                                 |
|                                               | 后置条件 | 增加新的销售策略                                             |
|                                               | 语法     | CouponVO addHotelTargetRoomCoupon(HotelTargetRoomCouponVO couponVO); |
| couponService.addHotelTargetRoomCoupon        | 前置条件 | 输入信息合法                                                 |
|                                               | 后置条件 | 增加新的销售策略                                             |
|                                               | 语法     | CouponVO addHotelTimeCoupon(HotelTimeCouponVO couponVO);     |
| couponService.addHotelTimeCoupon              | 前置条件 | 输入信息合法                                                 |
|                                               | 后置条件 | 增加新的销售策略                                             |
|                                               | 语法     | CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO); |
| couponService.addHotelTargetMoneyCoupon       | 前置条件 | 输入信息合法                                                 |
|                                               | 后置条件 | 增加新的销售策略                                             |
|                                               | 语法     | Coupon<br />couponService.addHotelTargetMoneyCoupon<br />(hotelTargetMoneyCouponVO) |
| couponService.<br />addHotelTargetMoneyCoupon | 前置条件 | 创建HotelTargetMoneyCouponVO类且符合语法输入条件             |
|                                               | 后置条件 | 添加满减优惠券                                               |
|                                               | 语法     | ResponseVO getHotelAllCoupons(Integer hotelId)               |
| getHotelAllCoupons                            | 前置条件 | 符合语法输入条件                                             |
|                                               | 后置条件 | 返回某酒店的所有优惠券信息                                   |
|                                               | 语法     | ResponseVO getOrderMatchCoupons(Integer userId,                                        hotelId, Double orderPrice,  Integer roomNum, String checkIn,  String checkOut) |
| getOrderMatchCoupons                          | 前置条件 | 符合语法输入条件                                             |
|                                               | 后置条件 | 返回符合订单条件的优惠券                                     |



coupon

**供接口**

| 接口名                                  | 属性     | 内容                                                         |
| --------------------------------------- | -------- | ------------------------------------------------------------ |
|                                         | 语法     | public boolean isMatch(OrderVO orderVO, Coupon coupon)       |
| CouponMatchStrategy.isMatch             | 前置条件 | orderVO和coupon对象均不为Null                                |
|                                         | 后置条件 | 得到一个布尔值作为结果，表示优惠券是否在这个订单上可用。     |
|                                         | 语法     | public List<Coupon> getMatchOrderCoupon(OrderVO orderVO)     |
| CouponService.getMatchOrderCoupon       | 前置条件 | orderVO对象不为空，orderVO.hotelId在数据库中存在             |
|                                         | 后置条件 | 查找到所有适用的优惠券，并得到一个列表。                     |
|                                         | 语法     | public List<Coupon> getHotelAllCoupon(Integer hotelId)       |
| CouponService.getHotelAllCoupon         | 前置条件 | hotelId必须是数据库中已经存在的合法值。                      |
|                                         | 后置条件 | 查找到所有对应酒店的优惠券，得到一个列表。                   |
|                                         | 语法     | public CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO) |
| CouponService.addHotelTargetMoneyCoupon | 前置条件 | 输入的couponVO对象的成员变量符合要求。                       |
|                                         | 后置条件 | 在数据库中插入了一个新的满减优惠券，并得到它在数据库中的ID。 |
|                                         | 语法     | public CouponVO addHotelTimeCoupon(HotelTimeCouponVO couponVO) |
| CouponService.addHotelTimeCoupon        | 前置条件 | 输入的couponVO对象的成员变量符合要求。                       |
|                                         | 后置条件 | 在数据库中插入了一个新的限时优惠券，并得到它在数据库中的ID。 |
|                                         | 语法     | public CouponVO addHotelTargetRoomCoupon(HotelTargetRoomCouponVO couponVO) |
| CouponService.addHotelTargetRoomCoupon  | 前置条件 | 输入的couponVO对象的成员变量符合要求。                       |
|                                         | 后置条件 | 在数据库中插入了一个新的多间优惠券，并得到它在数据库中的ID。 |
|                                         | 语法     | public CouponVO addHotelBirthdayCoupon(HotelBirthdayCouponVO couponVO) |
| CouponService.addHotelBirthdayCoupon    | 前置条件 | 输入的couponVO对象的成员变量符合要求。                       |
|                                         | 后置条件 | 在数据库中插入了一个新的生日优惠券，并得到它在数据库中的ID。 |
|                                         | 语法     | public ResponseVO deleteCoupon(int couponId)                 |
| CouponService.deleteCoupon              | 前置条件 | 输入的couponid在数据库中存在记录                             |
|                                         | 后置条件 | 删除对应id的优惠券                                           |

**需接口**

| 服务名                                        | 服务                                             |
| --------------------------------------------- | ------------------------------------------------ |
| CouponMapper.selectByHotelId(int id)          | 从数据库中查询并获取对应酒店的所有优惠策略列表。 |
| CouponMapper.insertCoupon(coupon c)           | 向数据库中插入单一持久化优惠策略对象。           |
| AccountService.getUserInfo(int id)            | 通过id获取用户信息                               |
| User.getBirthday()                            | 获取用户生日                                     |
| CouponVO.getDescription()                     | 获取优惠券描述                                   |
| CouponVO.getName()                            | 获取优惠券名字                                   |
| CouponVO.getType()                            | 获取优惠券类型                                   |
| CouponVO.getHotelId()                         | 获取适用酒店ID                                   |
| CouponVO.getDiscountMoney()                   | 获取折扣金额                                     |
| HotelTargetMoneyCouponVO.getTargetMoney()     | 获取满减目标金额                                 |
| HotelTargetRoomCouponVO.getTargetRoom()       | 获取多间目标间数                                 |
| HotelTimeCouponVO.getStartTime()              | 获取限时开始时间                                 |
| HotelTimeCouponVO.getEndTime()                | 获取限时结束时间                                 |
| OrderVO.getCheckInDate()                      | 获取订单入住日期                                 |
| OrderVO.getCheckOutDate()                     | 获取订单退房日期                                 |
| OrderVO.getRoomNum()                          | 获取订单房间数                                   |
| OrderVO.getPrice()                            | 获取订单总价（折后）                             |
| Coupon.setStartTime(Date startTime)           | 设置限时开始时间                                 |
| Coupon.setEndTime(Date endTime)               | 设置限时结束时间                                 |
| Coupon.setDescription(String description)     | 设置优惠券描述                                   |
| Coupon.setCouponName(String couponName)       | 设置优惠券名字                                   |
| Coupon.setTargetMoney(double targetMoney)     | 设置满减目标金额                                 |
| Coupon.setTargetRoom(double targetRoom)       | 设置多间目标间数                                 |
| Coupon.setDiscountMoney(double discountMoney) | 设置折扣金额                                     |
| Coupon.setHotelId(Integer hotelId)            | 设置适用酒店id                                   |
| Coupon.setCouponType(Integer couponType)      | 设置优惠券类型                                   |
| Coupon.setStatus(Integer status)              | 设置优惠券状态                                   |
| Coupon.getTargetMoney()                       | 获取满减目标金额                                 |
| Coupon.getTargetRoom()                        | 获取多间目标间数                                 |
| Coupon.getStartTime()                         | 获取限时开始时间                                 |
| Coupon.getEndTime()                           | 获取限时结束时间                                 |
| Coupon.getCouponType()                        | 获取优惠券类型                                   |
| ResponseVO.buildSuccess(true)                 | 返回成功信息                                     |
| ResponseVO.buildFailure（String massage）     | 返回失败信息                                     |

##### (4)业务逻辑层的动态模型

如图是添加满减优惠券时的业务逻辑层相关对象间的协作![](https://wx1.sbimg.cn/2020/06/18/-17.png)

如图是Coupon对象在生存期间的状态序列、引起的转移事件以及伴随动作。只是很简单的由UI调用hotelTargetMoneyAPI后转移到AddCoupon状态，随后结束。

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E5%AF%B9%E8%B1%A1%E7%8A%B6%E6%80%81%E5%9B%BE.png)

##### (5)业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同领域的对象。

#### 4.1.4 Adminbl模块

##### (1)模块概述

Adminbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

Adminbl模块的职责及接口参见软件体系结构描述文档。

##### (2)整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。在展示层与业务逻辑层之间添加了AdminService接口，业务逻辑层与数据层之间添加了AdminMapper接口。为了隔离业务逻职责和逻辑控制职责，我们增加了AdminController。UserPO是用户（管理员）持久化对象被添加到设计模型中去的。同时加入strategyList存放策略匹配方法。

Adminbl模块的设计如图所示

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/adminbl%E6%A8%A1%E5%9D%97%E8%AE%BE%E8%AE%A1.png)

模块中各个类的职责如表所示

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| AdminController | 实现管理员页面所需要的服务                                   |
| Admin           | 管理员的领域模型对象，拥有类型、id、email等信息，可以完成管理员页面所需服务 |

##### (3)模块内部类的接口规范

AdminController和Admin的接口规范如表所示。

AdminController

**供接口**

| 接口名         | 属性     | 内容                                                         |
| -------------- | -------- | ------------------------------------------------------------ |
|                | 语法     | public ResponseVO deleteOrder(@PathVariable int userid){     return adminService.deleteUser(userid) |
| deleteOrder    | 前置条件 | 有现存的有效用户                                             |
|                | 后置条件 | 数据库更新，删除对应订单                                     |
|                | 语法     | public ResponseVO updateInfo(@RequestBody UserForm userForm,@PathVariable int id) |
| updateInfo     | 前置条件 | 有现存的有效用户，输入数据合法                               |
|                | 后置条件 | 用户数据更新                                                 |
|                | 语法     | public ResponseVO addCredit(@PathVariable int id,@PathVariable String credit) |
| addCredit      | 前置条件 | 有现存的有效用户                                             |
|                | 后置条件 | 数据库更新，用户信用值更新                                   |
|                | 语法     | public ResponseVO getAllUsers(){     return ResponseVO.buildSuccess(adminService.getAllUsers()) |
| getAllUsers    | 前置条件 | 数据库连接和运行正常                                         |
|                | 后置条件 | 返回用户数据                                                 |
|                | 语法     | public ResponseVO addUser(@RequestBody UserForm userForm)    |
| addUser        | 前置条件 | 输入数据合法                                                 |
|                | 后置条件 | 数据库更新，增加新的用户                                     |
|                | 语法     | public ResponseVO updateManager(@RequestBody UserForm userForm,@PathVariable int id) |
| updateManager  | 前置条件 | 有现存的有效用户，输入数据合法                               |
|                | 后置条件 | 管理员数据更新                                               |
|                | 语法     | ResponseVO addManager(UserForm userForm)                     |
| addManager     | 前置条件 | 符合语法输入条件                                             |
|                | 后置条件 | 调用Admin对应的addManager方法                                |
|                | 语法     | ResponseVO getAllManagers()                                  |
| getAllManagers | 前置条件 | 符合语法输入条件                                             |
|                | 后置条件 | 调用Admin对应的getAllManagers方法                            |

需接口

| 接口名                                  | 属性     | 内容                                                |
| --------------------------------------- | -------- | --------------------------------------------------- |
|                                         | 语法     | ResponseVO updateUser(int id,UserForm userForm);    |
| adminService.updateUser(id,userForm)    | 前置条件 | 输入数据合法，有现存的有效用户                      |
|                                         | 后置条件 | 更新用户数据                                        |
|                                         | 语法     | ResponseVO deleteUser(int userid)                   |
| adminService.deleteUser(userid)         | 前置条件 | 有现存的有效用户                                    |
|                                         | 后置条件 | 更新用户数据                                        |
|                                         | 语法     | List<User> getAllUsers();                           |
| adminService.getAllUsers())             | 前置条件 | 数据库连接和运行正常                                |
|                                         | 后置条件 | 返回用户数据                                        |
|                                         | 语法     | ResponseVO updateCredit(int id,String credit);      |
| adminService.updateCredit(id,credit)    | 前置条件 | 有现存的有效用户                                    |
|                                         | 后置条件 | 更新用户信用值                                      |
|                                         | 语法     | ResponseVO addUser(UserForm userForm);              |
| adminService.addUser(userForm)          | 前置条件 | 输入数据合法                                        |
|                                         | 后置条件 | 数据库增加新的用户                                  |
|                                         | 语法     | ResponseVO updateManager(UserForm userForm,int id); |
| adminService.updateManager(userForm,id) | 前置条件 | 输入数据合法                                        |
|                                         | 后置条件 | 更新管理员信息                                      |
|                                         | 语法     | adminService.addManager(userForm)                   |
| adminService.addManager                 | 前置条件 | 符合语法输入条件                                    |
|                                         | 后置条件 | 添加新的酒店管理员                                  |
|                                         | 语法     | adminService.getAllManagers()                       |
| adminService.getAllManagers             | 前置条件 | 符合语法输入条件                                    |
|                                         | 后置条件 | 返回所有酒店管理员信息                              |
|                                         | 语法     | ResponseVO buildSuccess(Object content)             |
| buildSuccess                            | 前置条件 | 符合语法输入条件                                    |
|                                         | 后置条件 | 返回创建成功的信息                                  |

admin

**供接口**

| 接口名                      | 属性     | 内容                                                      |
| --------------------------- | -------- | --------------------------------------------------------- |
|                             | 语法     | public ResponseVO addManager(UserForm userForm)           |
| AdminService.addManager     | 前置条件 | 输入符合规范                                              |
|                             | 后置条件 | 数据库内容更新，增添新的manager                           |
|                             | 语法     | public List getAllManagers()                              |
| AdminService.getAllManagers | 前置条件 | 无                                                        |
|                             | 后置条件 | 返回所有manager数据                                       |
|                             | 语法     | public ResponseVO updateManager(UserForm userForm,int id) |
| AdminService.updateManager  | 前置条件 | 酒店管理人员id已存入数据库，更新信息符合规范              |
|                             | 后置条件 | 更新酒店管理员信息                                        |
|                             | 语法     | public ResponseVO addUser(UserForm userForm)              |
| AdminService.addUser        | 前置条件 | 输入信息符合规范                                          |
|                             | 后置条件 | 新增一般用户                                              |
|                             | 语法     | public ResponseVO updateCredit(int id,String credit)      |
| AdminService.updateCredit   | 前置条件 | 一般用户id已存入数据库，信用值记录符合规范                |
|                             | 后置条件 | 更新信用值变更记录                                        |
|                             | 语法     | public List<User> getAllUsers()                           |
| AdminService.getAllUsers    | 前置条件 | 无                                                        |
|                             | 后置条件 | 返回所有一般用户列表                                      |
|                             | 语法     | public ResponseVO deleteUser(int userid)                  |
| AdminService.deleteUser     | 前置条件 | 一般用户id已存入数据库                                    |
|                             | 后置条件 | 删除对应id用户                                            |
|                             | 语法     | public ResponseVO updateUser(int id,UserForm userForm)    |
| AdminService.updateUser     | 前置条件 | 一般用户id已存入数据库，更新信息符合规范                  |
|                             | 后置条件 | 更新一般用户信息                                          |

**需接口**

| 服务名                                                      | 服务                       |
| ----------------------------------------------------------- | -------------------------- |
| User.setEmail(String email)                                 | 设置用户邮箱               |
| User.setPassword(String password)                           | 设置用户密码               |
| User.setUserType(UserType userType)                         | 设置用户类型               |
| User.setUserName(String userName)                           | 设置用户名                 |
| User.setPhoneNumber(String phoneNumber)                     | 设置用户电话号码           |
| User.setBirthday(Date birthday)                             | 设置用户生日               |
| User.setCredit(double credit)                               | 设置用户信用值             |
| User.getEmail()                                             | 获取用户邮箱               |
| User.getPassword()                                          | 获取用户密码               |
| User.getUsername()                                          | 获取用户类型               |
| User.getPhonenumber()                                       | 获取用户名                 |
| User.getBirthday()                                          | 获取用户生日               |
| User.getCredit()                                            | 获取用户信用值             |
| UserForm.getEmail()                                         | 从vo对象中获取用户邮箱     |
| UserForm.getPassword()                                      | 从vo对象中获取用户密码     |
| UserForm.getUsername()                                      | 从vo对象中获取用户名       |
| UserForm.getPhonenumber()                                   | 从vo对象中获取用户电话号码 |
| UserForm.getBirthday()                                      | 从vo对象中获取用户生日     |
| UserForm.getCredit()                                        | 从vo对象中获取用户信用值   |
| CreditRecord.setRestValue(double restValue)                 | 设置剩余信用值             |
| CreditRecord.setChangeTime(Date changeTime)                 | 设置变更日期               |
| CreditRecord.setChangeValue(double changeValue)             | 设置变更信用值             |
| CreditRecord.setReason(String reason)                       | 设置变更原因               |
| CreditRecord.setUserId(int userId)                          | 设置变更用户ID             |
| AccountService.getUserInfo(id)                              | 通过用户id获取用户信息     |
| AdminMapper.getAllManagers()                                | 获取所有manager信息        |
| AdminMapper.addManager(User user)                           | 增加新的酒店管理员         |
| AdminMapper.updateManager(User user)                        | 更新酒店管理员信息         |
| AdminMapper.addUser(User user)                              | 增加新的一般用户           |
| AdminMapper.deleteUser(int userid)                          | 删除对应id用户             |
| AdminMapper.updateCredit(int id,double credit)              | 更新对应id用户的信用值     |
| AdminMapper.updateUser(User user)                           | 更新一般用户信息           |
| AdminMapper.getAllUsers()                                   | 获取所有一般用户信息       |
| AccountMapper.insertCreditRecord(CreditRecord creditRecord) | 往账户中插入信用值变更记录 |
| ResponseVO.buildSuccess()                                   | 反馈构建成功               |
| ResponseVO.buildFailure(String message)                     | 反馈构建失败               |

##### (4)业务逻辑层的动态模型

如图是添加酒店管理员时的业务逻辑层相关对象间的协作

![](https://wx1.sbimg.cn/2020/06/18/-18.png)

如图是Admin对象在生存期间的状态序列、引起的转移事件以及伴随动作。只是很简单的由UI调用addManagerAPI后转移到AddAdmin状态，随后结束。

![](https://teamwork-1301107071.cos.ap-shanghai.myqcloud.com/img/hotel/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%B7%BB%E5%8A%A0%E9%85%92%E5%BA%97%E7%AE%A1%E7%90%86%E5%91%98%E7%8A%B6%E6%80%81%E5%9B%BE.png)

##### (5)业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同领域的对象。

#### 4.1.5 orderbl 模块

##### (1)模块概述

​	orderbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

​	orderbl模块的职责及接口参见软件体系结构描述文档。

##### (2)整体结构

​	根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。orderPo是作为订单记录的持久化对象被添加到设计模型中去的，orderVo作为值对象被添加到设计模型中去。responseVo作为值对象将信息反馈给展示层。

​	orderbl模块的设计：

![icon](https://wx2.sbimg.cn/2020/05/16/-4.png)



​	orderbl模块各个类的职责

|      模块      |               职责               |
| :------------: | :------------------------------: |
|  HotelService  |         负责对接酒店服务         |
| AccountService |       负责对接用户信息服务       |
|  OrderMapper   |         与数据层进行交互         |
|     Order      | 订单持久对象，用于对接数据库信息 |
|      User      |  用户持久对象，用于对接用户信息  |
|    OrderVO     |   订单值对象，用于与展示层交互   |
|   ResponseVO   |        基于展示层反馈信息        |



##### (3)模块内部类的接口规范

orderController

供接口

| 接口名              | 属性     | 内容                                                         |
| ------------------- | -------- | ------------------------------------------------------------ |
|                     | 语法     | public ResponseVO reserveHotel(@RequestBody OrderVO orderVO) |
| reserveHotel        | 前置条件 | 输入信息合法                                                 |
|                     | 后置条件 | 返回对应酒店信息                                             |
|                     | 语法     | public ResponseVO retrieveAllOrders()                        |
| retrieveAllOrders   | 前置条件 | 数据库连接正常，调用者有相应的权限                           |
|                     | 后置条件 | 返回所有订单                                                 |
|                     | 语法     | public  ResponseVO retrieveUserOrders(@PathVariable int userid) |
| retrieveUserOrders  | 前置条件 | 有现存的有效用户                                             |
|                     | 后置条件 | 返回用户订单                                                 |
|                     | 语法     | public ResponseVO annulOrder(@PathVariable int orderid)      |
| annulOrder          | 前置条件 | 有现存的有效订单                                             |
|                     | 后置条件 | 数据库更新                                                   |
|                     | 语法     | public ResponseVO doOrder(@PathVariable int orderid)         |
| doOrder             | 前置条件 | 有现存的有效订单                                             |
|                     | 后置条件 | 数据库更新                                                   |
|                     | 语法     | public ResponseVO scoreOrder(@RequestParam int orderId,@RequestParam int value) |
| scoreOrder          | 前置条件 | 有现存的有效订单                                             |
|                     | 后置条件 | 数据库更新                                                   |
|                     | 语法     | public ResponseVO retrieveHotelOrders(@PathVariable Integer hotelId) |
| retrieveHotelOrders | 前置条件 | 有现存的有效酒店                                             |
|                     | 后置条件 | 返回酒店订单                                                 |
|                     | 语法     | public ResponseVO deleteOrder(@PathVariable int orderid)     |
| deleteOrder         | 前置条件 | 有现存的有效订单                                             |
|                     | 后置条件 | 数据库更新                                                   |

需接口

| 接口名                      | 属性     | 内容                                          |
| --------------------------- | -------- | --------------------------------------------- |
|                             | 语法     | ResponseVO addOrder(OrderVO orderVO);         |
| orderService.addOrder       | 前置条件 | 输入信息合法                                  |
|                             | 后置条件 | 返回对应酒店信息                              |
|                             | 语法     | List<Order> getAllOrders();                   |
| orderService.getAllOrders   | 前置条件 | 数据库连接正常，调用者有相应的权限            |
|                             | 后置条件 | 返回所有订单                                  |
|                             | 语法     | List<Order> getUserOrders(int userid);        |
| orderService.getUserOrders  | 前置条件 | 有现存的有效用户                              |
|                             | 后置条件 | 返回用户订单                                  |
|                             | 语法     | ResponseVO annulOrder(int orderId);           |
| orderService.annulOrder     | 前置条件 | 有现存的有效订单                              |
|                             | 后置条件 | 数据库更新                                    |
|                             | 语法     | ResponseVO doOrder(int orderid);              |
| orderService.doOrder        | 前置条件 | 有现存的有效订单                              |
|                             | 后置条件 | 数据库更新                                    |
|                             | 语法     | ResponseVO scoreOrder(int value,int orderId); |
| orderService.scoreOrder     | 前置条件 | 有现存的有效订单                              |
|                             | 后置条件 | 数据库更新                                    |
|                             | 语法     | List<Order> getHotelOrders(Integer hotelId);  |
| orderService.getHotelOrders | 前置条件 | 有现存的有效酒店                              |
|                             | 后置条件 | 返回酒店订单                                  |
|                             | 语法     | ResponseVO deleteOrder(int orderid);          |
| orderService.deleteOrder    | 前置条件 | 有现存的有效订单                              |
|                             | 后置条件 | 数据库更新                                    |

order

**供接口**

| 接口名                      | 属性     | 内容                                                         |
| --------------------------- | -------- | ------------------------------------------------------------ |
|                             | 语法     | public ResponseVO addOrder(OrderVO orderVO)                  |
| OrderService.addOrder       | 前置条件 | 订单对象不为Null                                             |
|                             | 后置条件 | 在数据库中插入单一持久化订单对象。                           |
|                             | 语法     | public List<Order> getAllOrders();                           |
| OrderService.getAllOrders   | 前置条件 | 数据库已启动并且可正常访问。                                 |
|                             | 后置条件 | 查询得到所有订单列表。                                       |
|                             | 语法     | public List<Order> getUserOrders(int userid);                |
| OrderService.getUserOrders  | 前置条件 | userid必须是数据库中已经存在的合法值。                       |
|                             | 后置条件 | 查找得到对应用户的订单数据对象列表。                         |
|                             | 语法     | ResponseVO annulOrder(int orderId);                          |
| OrderService.annulOrder     | 前置条件 | orderid必须是数据库中已经存在的合法值，而且订单状态不能为已撤销。 |
|                             | 后置条件 | 在数据库中更新对应订单对象的状态为已撤销。                   |
|                             | 语法     | public List<Order> getHotelOrders(Integer hotelId)           |
| OrderService.getHotelOrders | 前置条件 | 输入的酒店ID合法                                             |
|                             | 后置条件 | 返回在该酒店的所有订单                                       |
|                             | 语法     | public ResponseVO doOrder(int orderid)                       |
| OrderService.doOrder        | 前置条件 | 输入的订单ID合法                                             |
|                             | 后置条件 | 将订单的执行状态改为“已执行”                                 |
|                             | 语法     | public ResponseVO deleteOrder(int id)                        |
| OrderService.deleteOrder    | 前置条件 | 输入的订单ID合法                                             |
|                             | 后置条件 | 删除对应订单ID的订单                                         |
|                             | 语法     | public ResponseVO scoreOrder(int value, int orderId)         |
| OrderService.scoreOrder     | 前置条件 | 输入的评分值与订单ID合法                                     |
|                             | 后置条件 | 为酒店评分                                                   |

**需接口**

| 服务名                                                      | 服务                                   |
| ----------------------------------------------------------- | -------------------------------------- |
| AccountService.getUserInfo(int uid)                         | 获得id对应的用户数据对象               |
| HotelService.getRoomCurNum(int hid,roomType t)              | 获得对应酒店对应房间的数量             |
| HotelService.updateRoomInfo(int hid,roomTpye t,int n)       | 更新数据库中对应酒店对应房间的数量     |
| OrderVO.setCreateDate(String createDate)                    | 设置订单创建日期                       |
| OrderVO.setOrderState(String orderState)                    | 设置订单状态                           |
| OrderVO.setClientName(String clientName)                    | 设置用户名字                           |
| OrderVO.setPhoneNumber(String phoneNumber)                  | 设置电话号码                           |
| HotelVO.getRate()                                           | 获取酒店评分                           |
| HotelVO.getScoreNum()                                       | 获取酒店评分数                         |
| User.getId()                                                | 获取用户ID                             |
| CreditRecord.setRestValue(double restValue)                 | 设置剩余信用值                         |
| CreditRecord.setChangeTime(Date changeTime)                 | 设置变更时间                           |
| CreditRecord.setChangeValue(double changeValue)             | 设置变更值                             |
| CreditRecord.setReason(String reason)                       | 设置变更原因                           |
| CreditRecord.setUserId(int userId)                          | 设置用户ID                             |
| ResponseVO.buildSuccess(boolean t)                          | 发回正确信息的回复数据对象             |
| ResponseVO.buildFailure(String s)                           | 发回错误信息的回复数据对象             |
| OrderMapper.getAllOrders()                                  | 查询获得所有订单的数据对象列表         |
| OrderMapper.getUserOrders(int uid)                          | 查询获得对应id的用户的订单数据对象列表 |
| OrderMapper.getOrderById(int oid)                           | 查询获得对应id的订单数据对象           |
| OrderMapper.annulOrder(int oid)                             | 将数据库中对应订单的状态设置为“已撤销” |
| OrderMapper.doOrder(int oid)                                | 将数据库中对应订单的状态设置为“已执行” |
| OrderMapper.addOrder(Order o)                               | 向数据库中插入订单单一持久化对象       |
| OrderMapper.deleteOrder(int oid)                            | 删除数据库中对应订单号的订单           |
| OrderMapper.updateScore(int orderId)                        | 更新对应订单ID的订单                   |
| HotelMapper.updateScore(double value,int hotelId)           | 更新对应酒店ID的评分                   |
| HotelMapper.selectById(int id)                              | 按照id查询获得酒店数据对象             |
| AccountMapper.getAccountById(userId)                        | 通过用户ID获取用户信息                 |
| AccountMapper.updateCredit(int id,double credit)            | 更新对应ID用户的信用值                 |
| AccountMapper.insertCreditRecord(CreditRecord creditRecord) | 往账户中插入信用值变更记录             |



##### (4)业务逻辑层的动态模型

![icon](https://wx1.sbimg.cn/2020/06/18/-19.png)

![image](https://wx2.sbimg.cn/2020/05/15/-2.png)

##### (5)业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同领域的对象。



## 5.依赖视角

如图是依赖关系。

![](https://web-1302222241.cos.ap-nanjing.myqcloud.com/%E9%85%92%E5%BA%97%E9%A2%84%E8%AE%A2%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE%20%284%29.png)